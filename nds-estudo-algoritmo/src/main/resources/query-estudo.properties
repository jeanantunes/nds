queryUltimoProdutoEdicao=SELECT pe.ID, pe.PRODUTO_ID, pe.NUMERO_EDICAO, pe.PACOTE_PADRAO, p.CODIGO, l.DATA_LCTO_DISTRIBUIDOR, l.ID LANCAMENTO_ID, p.TIPO_SEGMENTO_PRODUTO_ID FROM produto_edicao pe JOIN produto p ON pe.PRODUTO_ID = p.ID JOIN lancamento l ON l.PRODUTO_EDICAO_ID = pe.ID AND L.STATUS = 'BALANCEADO' WHERE p.CODIGO = :CODIGO_PRODUTO ORDER BY NUMERO_EDICAO DESC LIMIT 1
queryEdicoesRecebidas=SELECT P.NOME, PE.NUMERO_EDICAO, EPC.QTDE_RECEBIDA, EPC.QTDE_DEVOLVIDA, PE.PARCIAL, PE.PESO, PE.ID as pedId, TSP.ID AS TIPO_SEGMENTO_PRODUTO_ID, TSP.DESCRICAO AS TIPO_SEGMENTO_PRODUTO_DESC, (CASE WHEN EXISTS(SELECT '.' FROM TIPO_PRODUTO TP WHERE TP.ID = P.TIPO_PRODUTO_ID AND TP.GRUPO_PRODUTO = 'COLECIONAVEL') THEN 1 ELSE 0 END) IS_COLECAO FROM ESTOQUE_PRODUTO_COTA EPC JOIN PRODUTO_EDICAO PE ON PE.ID = EPC.PRODUTO_EDICAO_ID JOIN PRODUTO P ON P.ID = PE.PRODUTO_ID JOIN TIPO_SEGMENTO_PRODUTO TSP ON TSP.ID = P.TIPO_SEGMENTO_PRODUTO_ID WHERE EPC.COTA_ID = :COTA_ID
queryQtdeVezesReenviadas=SELECT count(EPC.id) FROM ESTOQUE_PRODUTO_COTA EPC JOIN PRODUTO_EDICAO PE ON PE.ID = EPC.PRODUTO_EDICAO_ID WHERE EPC.COTA_ID = :COTA_ID AND PE.ID = :PRODUTO_EDICAO_ID and PE.parcial = 1

queryEdicoesLancamentos=SELECT l.ID, l.PRODUTO_EDICAO_ID, l.STATUS, l.DATA_LCTO_PREVISTA, l.DATA_LCTO_DISTRIBUIDOR, tp.GRUPO_PRODUTO, l.TIPO_LANCAMENTO, pe.NUMERO_EDICAO, p.CODIGO, plp.NUMERO_PERIODO, plp.TIPO FROM lancamento l LEFT JOIN produto_edicao pe ON pe.ID = l.PRODUTO_EDICAO_ID LEFT JOIN produto p ON p.ID = pe.PRODUTO_ID LEFT JOIN tipo_produto tp ON tp.ID = p.TIPO_PRODUTO_ID LEFT JOIN periodo_lancamento_parcial plp ON plp.LANCAMENTO_ID = l.ID WHERE pe.PRODUTO_ID = (SELECT ID FROM produto WHERE CODIGO = :CODIGO_PRODUTO) AND L.STATUS IN ('EXPEDIDO', 'EM_BALANCEAMENTO_RECOLHIMENTO', 'BALANCEADO_RECOLHIMENTO', 'EXCLUIDO_RECOLHIMENTO', 'FECHADO', 'RECOLHIDO') ORDER BY pe.NUMERO_EDICAO DESC, plp.NUMERO_PERIODO DESC LIMIT 50
queryLancamentosAnosAnterioresMesmoMes=SELECT l.ID, l.PRODUTO_EDICAO_ID, l.STATUS, l.DATA_LCTO_PREVISTA, l.DATA_LCTO_DISTRIBUIDOR, tp.GRUPO_PRODUTO, l.TIPO_LANCAMENTO, pe.NUMERO_EDICAO, p.CODIGO, plp.NUMERO_PERIODO, plp.TIPO FROM lancamento l LEFT JOIN produto_edicao pe ON pe.ID = l.PRODUTO_EDICAO_ID LEFT JOIN produto p ON p.ID = pe.PRODUTO_ID LEFT JOIN tipo_produto tp ON tp.ID = p.TIPO_PRODUTO_ID LEFT JOIN periodo_lancamento_parcial plp ON plp.LANCAMENTO_ID = l.ID WHERE pe.PRODUTO_ID = (SELECT ID FROM produto WHERE CODIGO = :CODIGO_PRODUTO) AND (EXTRACT(YEAR_MONTH FROM l.DATA_LCTO_DISTRIBUIDOR) = EXTRACT(YEAR_MONTH FROM ADDDATE(:DATA_LANCAMENTO, INTERVAL -1 YEAR)) OR EXTRACT(YEAR_MONTH FROM l.DATA_LCTO_DISTRIBUIDOR) = EXTRACT(YEAR_MONTH FROM ADDDATE(:DATA_LANCAMENTO, INTERVAL -2 YEAR))) ORDER BY pe.NUMERO_EDICAO DESC, plp.NUMERO_PERIODO DESC LIMIT 2
queryLancamentosAnosAnterioresVeraneio=SELECT l.ID, l.PRODUTO_EDICAO_ID, l.STATUS, l.DATA_LCTO_PREVISTA, l.DATA_LCTO_DISTRIBUIDOR, tp.GRUPO_PRODUTO, l.TIPO_LANCAMENTO, pe.NUMERO_EDICAO, p.CODIGO, plp.NUMERO_PERIODO, plp.TIPO FROM lancamento l LEFT JOIN produto_edicao pe ON pe.ID = l.PRODUTO_EDICAO_ID LEFT JOIN produto p ON p.ID = pe.PRODUTO_ID LEFT JOIN tipo_produto tp ON tp.ID = p.TIPO_PRODUTO_ID LEFT JOIN periodo_lancamento_parcial plp ON plp.LANCAMENTO_ID = l.ID WHERE pe.PRODUTO_ID = (SELECT ID FROM produto WHERE CODIGO = :CODIGO_PRODUTO) AND (l.DATA_LCTO_DISTRIBUIDOR BETWEEN :DATA0 AND :DATA1 OR l.DATA_LCTO_DISTRIBUIDOR BETWEEN :DATA2 AND :DATA3) ORDER BY pe.NUMERO_EDICAO DESC, plp.NUMERO_PERIODO DESC LIMIT 2

queryCotasFixadas=select ID_COTA, QTDE_EXEMPLARES from fixacao_reparte where ID_PRODUTO = :ID_PRODUTO and ED_INICIAL <= :NUMERO_EDICAO_ESTUDO and ED_FINAL >= :NUMERO_EDICAO_ESTUDO 
queryCotasDesenglobadas=select COTA_ID_DESENGLOBADA, COTA_ID_ENGLOBADA, PORCENTAGEM_COTA_ENGLOBADA, DATA_ALTERACAO from desenglobacao
queryCotaWithEstoqueProdutoCota=SELECT C.*, P.NOME FROM COTA C INNER JOIN PESSOA P ON (P.ID = C.PESSOA_ID) WHERE EXISTS (SELECT EPC.* FROM ESTOQUE_PRODUTO_COTA EPC WHERE EPC.COTA_ID = C.ID) ORDER BY C.ID
queryCotaEquivalente=SELECT CB.INDICE_AJUSTE, C.* FROM COTA_BASE_COTA CBC JOIN COTA_BASE CB ON (CB.ID = CBC.COTA_BASE_ID) JOIN COTA C ON (C.ID = CBC.COTA_ID) JOIN PESSOA P ON (P.ID = C.PESSOA_ID) WHERE CB.COTA_ID = :COTA_ID AND :DATA BETWEEN CB.DATA_INICIO AND CB.DATA_FIM
queryProdutoEdicaoPorCota=SELECT c.id AS COTA_ID, c.NUMERO_COTA, p.id AS PRODUTO_ID, pe.id AS PRODUTO_EDICAO_ID, l.id AS LANCAMENTO_ID, l.STATUS, l.TIPO_LANCAMENTO, tp.GRUPO_PRODUTO, l.DATA_LCTO_DISTRIBUIDOR, epc.QTDE_RECEBIDA, (epc.QTDE_RECEBIDA - epc.QTDE_DEVOLVIDA) AS QTDE_VENDA, pe.NUMERO_EDICAO, p.CODIGO, ar.AJUSTE_APLICADO, ar.FORMA_AJUSTE, mcp.REPARTE_MAX, mcp.REPARTE_MIN, (CASE WHEN MCP.REPARTE_MAX IS NOT NULL OR MCP.REPARTE_MIN IS NOT NULL THEN 1 ELSE 0 END) MIX, fr.QTDE_EXEMPLARES, (SELECT COUNT(*) FROM PDV WHERE COTA_ID = C.ID) QTDE_PDVS, RCR.REGIAO_ID FROM produto_edicao pe JOIN produto p ON pe.PRODUTO_ID = p.id JOIN lancamento l ON pe.ID = l.PRODUTO_EDICAO_ID JOIN tipo_produto tp ON tp.ID = p.TIPO_PRODUTO_ID JOIN estoque_produto_cota epc ON pe.ID = epc.PRODUTO_EDICAO_ID JOIN cota c ON c.ID = epc.COTA_ID LEFT JOIN REGISTRO_COTA_REGIAO RCR ON RCR.COTA_ID = C.ID LEFT JOIN ajuste_reparte ar ON ar.COTA_ID = epc.COTA_ID AND (AR.ID = :TIPO_SEGMENTO OR AR.ID IS NULL) LEFT JOIN mix_cota_produto mcp ON mcp.id_cota = c.id AND mcp.id_produto = :ID_PRODUTO LEFT JOIN fixacao_reparte fr ON fr.id_cota = c.id AND fr.id_produto = :ID_PRODUTO AND :NUMERO_EDICAO BETWEEN fr.ed_inicial AND fr.ed_final WHERE pe.id IN (:IDS_PRODUTOS) ORDER BY c.ID, pe.NUMERO_EDICAO DESC

queryReparteJuramentadoAFaturar=SELECT SUM(QTDE) FROM MOVIMENTO_ESTOQUE_COTA MEC WHERE TIPO_MOVIMENTO_ID = :TIPO_MOVIMENTO_ID AND MEC.COTA_ID = :COTA_ID AND MEC.PRODUTO_EDICAO_ID = :PRODUTO_EDICAO_ID ORDER BY ID
queryCotasOrdenadasPorSegmentoSemEdicaoBase=SELECT DISTINCT COTA_ID FROM RANKING_SEGMENTO WHERE RANKING_SEGMENTO_GERADOS_ID = (SELECT MAX(ID) FROM RANKING_SEGMENTO_GERADOS) AND COTA_ID IN (:IDS_COTA) AND PRODUTO_EDICAO_ID NOT IN (:IDS_PRODUTO_EDICAO)
queryCotasOrdenadasMaiorMenor=SELECT DISTINCT COTA_ID FROM RANKING_SEGMENTO RS WHERE RS.PRODUTO_EDICAO_ID = :PRODUTO_EDICAO_ID AND RANKING_SEGMENTO_GERADOS_ID = (SELECT MAX(ID) FROM RANKING_SEGMENTO_GERADOS) AND COTA_ID IN (:IDS_COTA)
queryRankingSegmentoEdicoesBase=(SELECT COTA_ID, PRODUTO_EDICAO_ID FROM RANKING_SEGMENTO RS WHERE RS.RANKING_SEGMENTO_GERADOS_ID = (SELECT MAX(RSG.ID) FROM RANKING_SEGMENTO_GERADOS RSG) AND RS.PRODUTO_EDICAO_ID IN (:IDS_BASE)) UNION (SELECT COTA_ID, PRODUTO_EDICAO_ID FROM MOVIMENTO_ESTOQUE_COTA MEC WHERE MEC.TIPO_MOVIMENTO_ID = 21 AND MEC.PRODUTO_EDICAO_ID IN (:IDS_BASE) AND MEC.QTDE # :QTDE)
queryCotasOrdenadasPorSegmentoEdicaoAberta=SELECT DISTINCT COTA_ID FROM RANKING_SEGMENTO WHERE RANKING_SEGMENTO_GERADOS_ID = (SELECT MAX(ID) FROM RANKING_SEGMENTO_GERADOS) AND COTA_ID IN (:COTA_IDS)

insertEstudo=INSERT INTO estudo (produto_edicao_id, lancamento_id, liberado, reparte_distribuir, sobra, distribuicao_por_multiplos, pacote_padrao, data_cadastro, data_lancamento, qtde_reparte, status) VALUES (:produtoEdicaoEstudo.id, :produtoEdicaoEstudo.idLancamento, false, :reparteDistribuirInicial, :reparteDistribuir, :distribuicaoPorMultiplos, :pacotePadrao, :dataCadastro, :produtoEdicaoEstudo.dataLancamento, :reparteDistribuirInicial, :statusEstudo)
insertEstudoCotas=INSERT INTO estudo_cota (cota_id, estudo_id, qtde_prevista, qtde_efetiva, classificacao, reparte, venda_media, venda_media_nominal, reparte_juramentado_a_faturar, quantidade_pdvs, reparte_minimo, reparte_maximo, venda_media_mais_n, indice_correcao_tendencia, indice_venda_crescente, percentual_encalhe_maximo, mix) VALUES (:id, :idEstudo, :reparteCalculado, :reparteCalculado, :classificacao.codigo, :reparteCalculado, :vendaMedia, :vendaMediaNominal, :reparteJuramentadoAFaturar, :quantidadePDVs, :reparteMinimo, :reparteMaximo, :vendaMediaMaisN, :indiceCorrecaoTendencia, :indiceVendaCrescente, :percentualEncalheMaximo, :mix)
insertProdutoEdicao=INSERT INTO estudo_produto_edicao (estudo_id, cota_id, produto_edicao_id, reparte, venda, indice_correcao, venda_corrigida) VALUES (:idEstudo, :idCota, :id, :reparte, :venda, :indiceCorrecao, :vendaCorrigida)
insertProdutoEdicaoBase=INSERT INTO estudo_produto_edicao_base (estudo_id, produto_edicao_id, colecao, parcial, edicao_aberta, peso) VALUES (:idEstudo, :id, :colecao, :parcial, :edicaoAberta, :indicePeso)

queryParametrosDistribuidor=SELECT COMPLEMENTAR_AUTOMATICO, GERACAO_AUTOMATICA_ESTUDO, PERCENTUAL_MAXIMO_FIXACAO, PRACA_VERANEIO, VENDA_MEDIA_MAIS FROM distribuidor_grid_distribuicao
queryPercentuaisExcedentes=SELECT EFICIENCIA, PDV, VENDA FROM distribuidor_percentual_excedente;
